##Set working directory
#Ellen's working directory:
setwd("C:/Users/elwel/OneDrive/Desktop/AmongTheDung")
#Ben's working directory:

# attach data
drivEst <- read.csv("outputs/DriverModelOutputs/BodySize_CurrentConditions.csv")

options(scipen=999)

##save plot
tiff(filename = "plots/Drivers_BodySize_Contemporary.tiff", width = 9, height = 4, units = 'in', res = 600, compression = 'lzw')

##layout
layout(mat = matrix(c(1:4), 
                        nrow = 1, 
                        ncol = 4),
       heights = c(2,2,2,2),
       widths = c(1.3,2,2,2))

par(mar=c(4,0.4,0.4,0.8))
#empty plot for where the labels will go
plot(0, xaxt = 'n', yaxt = 'n', bty = 'n', pch = '', ylab = '', xlab = '')

#### CP #####
sub <- subset(drivEst, spp == "CP")
subQ <- c(sub$Q5[2:7],sub$Q95[2:7])
est <- sub$Estimate[2:7]
yy <- c(1:6)
plot(yy ~ est, ylab="",xlab="", yaxt="n", las=1, type="n",xlim=c(min(subQ),max(subQ)+0.5), ylim=c(0.8,6.8),cex=2, bty="n")
segments(x0=0,y0=0,x1=0,y1=6.5,lty=2, lwd=2,col="grey60")
axis(2, at=yy, lwd = 0, lwd.ticks = 0, labels=c("Temperature", "Plant quality", "Browser dung", "Grazer dung", "PD dung", "Intraspecific density"), las=1,cex.axis=1.5)
title(xlab="Estimate", line=2.4,cex.lab=1.3)
legend("topleft", legend=("A) C. pilularius"), bty="n", cex=1.3)
mm <- cbind(yy,est)
mm_neg <- as.data.frame(mm[ which(est < 0),])
mm_pos <- as.data.frame(mm[ which(est > 0),])
#points(yy ~ est, pch="l",cex=2.2,col="white")
points(mm_neg$yy ~ mm_neg$est, pch="l",cex=4,col="firebrick2")
points(mm_pos$yy ~ mm_pos$est, pch="l",cex=4,col="dodgerblue")
points(mm_neg[1,] ~ mm_neg[2,], pch="l",cex=4,col="firebrick2")
points(mm_pos[1,] ~ mm_pos[2,], pch="l",cex=4,col="dodgerblue")
yyy1=c(0.975,1.025,1.025,0.975)
yyy2=c(0.95,1.05,1.05,0.95)
yyy3=c(0.9,1.1,1.1,0.9)

polygon(x=c(if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}),y=(yyy1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}),y=(yyy2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[2]<0) {sub$Q20[2]} else {0}, if (sub$Q20[2]<0) {sub$Q20[2]} else {0}, if (sub$Q80[2]<0) {sub$Q80[2]} else {0}, if (sub$Q80[2]<0) {sub$Q80[2]} else {0}),y=(yyy3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}),y=(yyy1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}),y=(yyy2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[2]>0) {sub$Q20[2]} else {0}, if (sub$Q20[2]>0) {sub$Q20[2]} else {0}, if (sub$Q80[2]>0) {sub$Q80[2]} else {0}, if (sub$Q80[2]>0) {sub$Q80[2]} else {0}),y=(yyy3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}),y=(yyy1+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}),y=(yyy2+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[3]<0) {sub$Q20[3]} else {0}, if (sub$Q20[3]<0) {sub$Q20[3]} else {0}, if (sub$Q80[3]<0) {sub$Q80[3]} else {0}, if (sub$Q80[3]<0) {sub$Q80[3]} else {0}),y=(yyy3+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}),y=(yyy1+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}),y=(yyy2+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[3]>0) {sub$Q20[3]} else {0}, if (sub$Q20[3]>0) {sub$Q20[3]} else {0}, if (sub$Q80[3]>0) {sub$Q80[3]} else {0}, if (sub$Q80[3]>0) {sub$Q80[3]} else {0}),y=(yyy3+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}),y=(yyy1+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}),y=(yyy2+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[4]<0) {sub$Q20[4]} else {0}, if (sub$Q20[4]<0) {sub$Q20[4]} else {0}, if (sub$Q80[4]<0) {sub$Q80[4]} else {0}, if (sub$Q80[4]<0) {sub$Q80[4]} else {0}),y=(yyy3+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}),y=(yyy1+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}),y=(yyy2+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[4]>0) {sub$Q20[4]} else {0}, if (sub$Q20[4]>0) {sub$Q20[4]} else {0}, if (sub$Q80[4]>0) {sub$Q80[4]} else {0}, if (sub$Q80[4]>0) {sub$Q80[4]} else {0}),y=(yyy3+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}),y=(yyy1+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}),y=(yyy2+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[5]<0) {sub$Q20[5]} else {0}, if (sub$Q20[5]<0) {sub$Q20[5]} else {0}, if (sub$Q80[5]<0) {sub$Q80[5]} else {0}, if (sub$Q80[5]<0) {sub$Q80[5]} else {0}),y=(yyy3+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}),y=(yyy1+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}),y=(yyy2+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[5]>0) {sub$Q20[5]} else {0}, if (sub$Q20[5]>0) {sub$Q20[5]} else {0}, if (sub$Q80[5]>0) {sub$Q80[5]} else {0}, if (sub$Q80[5]>0) {sub$Q80[5]} else {0}),y=(yyy3+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}),y=(yyy1+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}),y=(yyy2+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[6]<0) {sub$Q20[6]} else {0}, if (sub$Q20[6]<0) {sub$Q20[6]} else {0}, if (sub$Q80[6]<0) {sub$Q80[6]} else {0}, if (sub$Q80[6]<0) {sub$Q80[6]} else {0}),y=(yyy3+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}),y=(yyy1+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}),y=(yyy2+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[6]>0) {sub$Q20[6]} else {0}, if (sub$Q20[6]>0) {sub$Q20[6]} else {0}, if (sub$Q80[6]>0) {sub$Q80[6]} else {0}, if (sub$Q80[6]>0) {sub$Q80[6]} else {0}),y=(yyy3+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}),y=(yyy1+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}),y=(yyy2+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[7]<0) {sub$Q20[7]} else {0}, if (sub$Q20[7]<0) {sub$Q20[7]} else {0}, if (sub$Q80[7]<0) {sub$Q80[7]} else {0}, if (sub$Q80[7]<0) {sub$Q80[7]} else {0}),y=(yyy3+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}),y=(yyy1+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}),y=(yyy2+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[7]>0) {sub$Q20[7]} else {0}, if (sub$Q20[7]>0) {sub$Q20[7]} else {0}, if (sub$Q80[7]>0) {sub$Q80[7]} else {0}, if (sub$Q80[7]>0) {sub$Q80[7]} else {0}),y=(yyy3+5), col = "dodgerblue", border = NA)

#### onF #####
sub <- subset(drivEst, spp == "onF")
subQ <- c(sub$Q5[2:7],sub$Q95[2:7])
est <- sub$Estimate[2:7]
yy <- c(1:6)
plot(yy ~ est, ylab="",xlab="", yaxt="n", las=1, type="n",xlim=c(min(subQ),max(subQ)+0.05), ylim=c(0.8,6.8),cex=2, bty="n")
segments(x0=0,y0=0,x1=0,y1=6.5,lty=2, lwd=2,col="grey60")
title(xlab="Estimate", line=2.4,cex.lab=1.3)
legend("topleft", legend=("B) O. nuchicornis F"), bty="n", cex=1.3)
mm <- cbind(yy,est)
mm_neg <- as.data.frame(mm[ which(est < 0),])
mm_pos <- as.data.frame(mm[ which(est > 0),])
#points(yy ~ est, pch="l",cex=2.2,col="white")
points(mm_neg$yy ~ mm_neg$est, pch="l",cex=4,col="firebrick2")
points(mm_pos$yy ~ mm_pos$est, pch="l",cex=4,col="dodgerblue")
points(mm_neg[1,] ~ mm_neg[2,], pch="l",cex=4,col="firebrick2")
points(mm_pos[1,] ~ mm_pos[2,], pch="l",cex=4,col="dodgerblue")
yyy1=c(0.975,1.025,1.025,0.975)
yyy2=c(0.95,1.05,1.05,0.95)
yyy3=c(0.9,1.1,1.1,0.9)

polygon(x=c(if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}),y=(yyy1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}),y=(yyy2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[2]<0) {sub$Q20[2]} else {0}, if (sub$Q20[2]<0) {sub$Q20[2]} else {0}, if (sub$Q80[2]<0) {sub$Q80[2]} else {0}, if (sub$Q80[2]<0) {sub$Q80[2]} else {0}),y=(yyy3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}),y=(yyy1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}),y=(yyy2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[2]>0) {sub$Q20[2]} else {0}, if (sub$Q20[2]>0) {sub$Q20[2]} else {0}, if (sub$Q80[2]>0) {sub$Q80[2]} else {0}, if (sub$Q80[2]>0) {sub$Q80[2]} else {0}),y=(yyy3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}),y=(yyy1+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}),y=(yyy2+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[3]<0) {sub$Q20[3]} else {0}, if (sub$Q20[3]<0) {sub$Q20[3]} else {0}, if (sub$Q80[3]<0) {sub$Q80[3]} else {0}, if (sub$Q80[3]<0) {sub$Q80[3]} else {0}),y=(yyy3+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}),y=(yyy1+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}),y=(yyy2+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[3]>0) {sub$Q20[3]} else {0}, if (sub$Q20[3]>0) {sub$Q20[3]} else {0}, if (sub$Q80[3]>0) {sub$Q80[3]} else {0}, if (sub$Q80[3]>0) {sub$Q80[3]} else {0}),y=(yyy3+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}),y=(yyy1+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}),y=(yyy2+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[4]<0) {sub$Q20[4]} else {0}, if (sub$Q20[4]<0) {sub$Q20[4]} else {0}, if (sub$Q80[4]<0) {sub$Q80[4]} else {0}, if (sub$Q80[4]<0) {sub$Q80[4]} else {0}),y=(yyy3+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}),y=(yyy1+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}),y=(yyy2+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[4]>0) {sub$Q20[4]} else {0}, if (sub$Q20[4]>0) {sub$Q20[4]} else {0}, if (sub$Q80[4]>0) {sub$Q80[4]} else {0}, if (sub$Q80[4]>0) {sub$Q80[4]} else {0}),y=(yyy3+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}),y=(yyy1+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}),y=(yyy2+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[5]<0) {sub$Q20[5]} else {0}, if (sub$Q20[5]<0) {sub$Q20[5]} else {0}, if (sub$Q80[5]<0) {sub$Q80[5]} else {0}, if (sub$Q80[5]<0) {sub$Q80[5]} else {0}),y=(yyy3+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}),y=(yyy1+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}),y=(yyy2+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[5]>0) {sub$Q20[5]} else {0}, if (sub$Q20[5]>0) {sub$Q20[5]} else {0}, if (sub$Q80[5]>0) {sub$Q80[5]} else {0}, if (sub$Q80[5]>0) {sub$Q80[5]} else {0}),y=(yyy3+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}),y=(yyy1+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}),y=(yyy2+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[6]<0) {sub$Q20[6]} else {0}, if (sub$Q20[6]<0) {sub$Q20[6]} else {0}, if (sub$Q80[6]<0) {sub$Q80[6]} else {0}, if (sub$Q80[6]<0) {sub$Q80[6]} else {0}),y=(yyy3+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}),y=(yyy1+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}),y=(yyy2+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[6]>0) {sub$Q20[6]} else {0}, if (sub$Q20[6]>0) {sub$Q20[6]} else {0}, if (sub$Q80[6]>0) {sub$Q80[6]} else {0}, if (sub$Q80[6]>0) {sub$Q80[6]} else {0}),y=(yyy3+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}),y=(yyy1+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}),y=(yyy2+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[7]<0) {sub$Q20[7]} else {0}, if (sub$Q20[7]<0) {sub$Q20[7]} else {0}, if (sub$Q80[7]<0) {sub$Q80[7]} else {0}, if (sub$Q80[7]<0) {sub$Q80[7]} else {0}),y=(yyy3+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}),y=(yyy1+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}),y=(yyy2+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[7]>0) {sub$Q20[7]} else {0}, if (sub$Q20[7]>0) {sub$Q20[7]} else {0}, if (sub$Q80[7]>0) {sub$Q80[7]} else {0}, if (sub$Q80[7]>0) {sub$Q80[7]} else {0}),y=(yyy3+5), col = "dodgerblue", border = NA)


#### onM #####
sub <- subset(drivEst, spp == "onF")
subQ <- c(sub$Q5[2:7],sub$Q95[2:7])
est <- sub$Estimate[2:7]
yy <- c(1:6)
plot(yy ~ est, ylab="",xlab="", yaxt="n", las=1, type="n",xlim=c(min(subQ)-0.1,max(subQ)+0.1), ylim=c(0.8,6.8),cex=2, bty="n")
segments(x0=0,y0=0,x1=0,y1=6.5,lty=2, lwd=2,col="grey60")
title(xlab="Estimate", line=2.4,cex.lab=1.3)
legend("topleft", legend=("B) O. nuchicornis M"), bty="n", cex=1.3)
mm <- cbind(yy,est)
mm_neg <- as.data.frame(mm[ which(est < 0),])
mm_pos <- as.data.frame(mm[ which(est > 0),])
#points(yy ~ est, pch="l",cex=2.2,col="white")
points(mm_neg$yy ~ mm_neg$est, pch="l",cex=4,col="firebrick2")
points(mm_pos$yy ~ mm_pos$est, pch="l",cex=4,col="dodgerblue")
points(mm_neg[1,] ~ mm_neg[2,], pch="l",cex=4,col="firebrick2")
points(mm_pos[1,] ~ mm_pos[2,], pch="l",cex=4,col="dodgerblue")
yyy1=c(0.975,1.025,1.025,0.975)
yyy2=c(0.95,1.05,1.05,0.95)
yyy3=c(0.9,1.1,1.1,0.9)

polygon(x=c(if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q5[2]<0) {sub$Q5[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}, if (sub$Q95[2]<0) {sub$Q95[2]} else {0}),y=(yyy1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q10[2]<0) {sub$Q10[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}, if (sub$Q90[2]<0) {sub$Q90[2]} else {0}),y=(yyy2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[2]<0) {sub$Q20[2]} else {0}, if (sub$Q20[2]<0) {sub$Q20[2]} else {0}, if (sub$Q80[2]<0) {sub$Q80[2]} else {0}, if (sub$Q80[2]<0) {sub$Q80[2]} else {0}),y=(yyy3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q5[2]>0) {sub$Q5[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}, if (sub$Q95[2]>0) {sub$Q95[2]} else {0}),y=(yyy1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q10[2]>0) {sub$Q10[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}, if (sub$Q90[2]>0) {sub$Q90[2]} else {0}),y=(yyy2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[2]>0) {sub$Q20[2]} else {0}, if (sub$Q20[2]>0) {sub$Q20[2]} else {0}, if (sub$Q80[2]>0) {sub$Q80[2]} else {0}, if (sub$Q80[2]>0) {sub$Q80[2]} else {0}),y=(yyy3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q5[3]<0) {sub$Q5[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}, if (sub$Q95[3]<0) {sub$Q95[3]} else {0}),y=(yyy1+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q10[3]<0) {sub$Q10[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}, if (sub$Q90[3]<0) {sub$Q90[3]} else {0}),y=(yyy2+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[3]<0) {sub$Q20[3]} else {0}, if (sub$Q20[3]<0) {sub$Q20[3]} else {0}, if (sub$Q80[3]<0) {sub$Q80[3]} else {0}, if (sub$Q80[3]<0) {sub$Q80[3]} else {0}),y=(yyy3+1), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q5[3]>0) {sub$Q5[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}, if (sub$Q95[3]>0) {sub$Q95[3]} else {0}),y=(yyy1+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q10[3]>0) {sub$Q10[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}, if (sub$Q90[3]>0) {sub$Q90[3]} else {0}),y=(yyy2+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[3]>0) {sub$Q20[3]} else {0}, if (sub$Q20[3]>0) {sub$Q20[3]} else {0}, if (sub$Q80[3]>0) {sub$Q80[3]} else {0}, if (sub$Q80[3]>0) {sub$Q80[3]} else {0}),y=(yyy3+1), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q5[4]<0) {sub$Q5[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}, if (sub$Q95[4]<0) {sub$Q95[4]} else {0}),y=(yyy1+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q10[4]<0) {sub$Q10[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}, if (sub$Q90[4]<0) {sub$Q90[4]} else {0}),y=(yyy2+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[4]<0) {sub$Q20[4]} else {0}, if (sub$Q20[4]<0) {sub$Q20[4]} else {0}, if (sub$Q80[4]<0) {sub$Q80[4]} else {0}, if (sub$Q80[4]<0) {sub$Q80[4]} else {0}),y=(yyy3+2), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q5[4]>0) {sub$Q5[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}, if (sub$Q95[4]>0) {sub$Q95[4]} else {0}),y=(yyy1+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q10[4]>0) {sub$Q10[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}, if (sub$Q90[4]>0) {sub$Q90[4]} else {0}),y=(yyy2+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[4]>0) {sub$Q20[4]} else {0}, if (sub$Q20[4]>0) {sub$Q20[4]} else {0}, if (sub$Q80[4]>0) {sub$Q80[4]} else {0}, if (sub$Q80[4]>0) {sub$Q80[4]} else {0}),y=(yyy3+2), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q5[5]<0) {sub$Q5[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}, if (sub$Q95[5]<0) {sub$Q95[5]} else {0}),y=(yyy1+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q10[5]<0) {sub$Q10[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}, if (sub$Q90[5]<0) {sub$Q90[5]} else {0}),y=(yyy2+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[5]<0) {sub$Q20[5]} else {0}, if (sub$Q20[5]<0) {sub$Q20[5]} else {0}, if (sub$Q80[5]<0) {sub$Q80[5]} else {0}, if (sub$Q80[5]<0) {sub$Q80[5]} else {0}),y=(yyy3+3), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q5[5]>0) {sub$Q5[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}, if (sub$Q95[5]>0) {sub$Q95[5]} else {0}),y=(yyy1+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q10[5]>0) {sub$Q10[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}, if (sub$Q90[5]>0) {sub$Q90[5]} else {0}),y=(yyy2+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[5]>0) {sub$Q20[5]} else {0}, if (sub$Q20[5]>0) {sub$Q20[5]} else {0}, if (sub$Q80[5]>0) {sub$Q80[5]} else {0}, if (sub$Q80[5]>0) {sub$Q80[5]} else {0}),y=(yyy3+3), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q5[6]<0) {sub$Q5[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}, if (sub$Q95[6]<0) {sub$Q95[6]} else {0}),y=(yyy1+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q10[6]<0) {sub$Q10[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}, if (sub$Q90[6]<0) {sub$Q90[6]} else {0}),y=(yyy2+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[6]<0) {sub$Q20[6]} else {0}, if (sub$Q20[6]<0) {sub$Q20[6]} else {0}, if (sub$Q80[6]<0) {sub$Q80[6]} else {0}, if (sub$Q80[6]<0) {sub$Q80[6]} else {0}),y=(yyy3+4), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q5[6]>0) {sub$Q5[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}, if (sub$Q95[6]>0) {sub$Q95[6]} else {0}),y=(yyy1+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q10[6]>0) {sub$Q10[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}, if (sub$Q90[6]>0) {sub$Q90[6]} else {0}),y=(yyy2+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[6]>0) {sub$Q20[6]} else {0}, if (sub$Q20[6]>0) {sub$Q20[6]} else {0}, if (sub$Q80[6]>0) {sub$Q80[6]} else {0}, if (sub$Q80[6]>0) {sub$Q80[6]} else {0}),y=(yyy3+4), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q5[7]<0) {sub$Q5[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}, if (sub$Q95[7]<0) {sub$Q95[7]} else {0}),y=(yyy1+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q10[7]<0) {sub$Q10[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}, if (sub$Q90[7]<0) {sub$Q90[7]} else {0}),y=(yyy2+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q20[7]<0) {sub$Q20[7]} else {0}, if (sub$Q20[7]<0) {sub$Q20[7]} else {0}, if (sub$Q80[7]<0) {sub$Q80[7]} else {0}, if (sub$Q80[7]<0) {sub$Q80[7]} else {0}),y=(yyy3+5), col = "firebrick2", border = NA)
polygon(x=c(if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q5[7]>0) {sub$Q5[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}, if (sub$Q95[7]>0) {sub$Q95[7]} else {0}),y=(yyy1+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q10[7]>0) {sub$Q10[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}, if (sub$Q90[7]>0) {sub$Q90[7]} else {0}),y=(yyy2+5), col = "dodgerblue", border = NA)
polygon(x=c(if (sub$Q20[7]>0) {sub$Q20[7]} else {0}, if (sub$Q20[7]>0) {sub$Q20[7]} else {0}, if (sub$Q80[7]>0) {sub$Q80[7]} else {0}, if (sub$Q80[7]>0) {sub$Q80[7]} else {0}),y=(yyy3+5), col = "dodgerblue", border = NA)

dev.off()
##